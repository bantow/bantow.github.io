"use strict";!function(){var e,t,n,o,i,r=window.innerHeight||document.documentElement.clientHeight,a=window.innerWidth||document.documentElement.clientWidth,l=r,s={},d=function(){if(e=document.getElementById("modal-scrollable-smad")||document.getElementById("scrollable-smad"),t=document.getElementById("modal-scrollable-video")||document.getElementById("scrollable-video"),e){var n=e.getBoundingClientRect();o=n.top-r,i=n.bottom-o,s.startActionUrl=e.getAttribute("data-video-quartile-start"),s.quartileActionUrl25=e.getAttribute("data-video-quartile-25"),s.quartileActionUrl50=e.getAttribute("data-video-quartile-50"),s.quartileActionUrl75=e.getAttribute("data-video-quartile-75"),s.quartileActionUrl100=e.getAttribute("data-video-quartile-100")}};setTimeout((function(){d(),(n=document.getElementById("dynamic-moments-cards-container"))&&(n.style.transform="translateX(".concat(200,"px)"))}),1e3);var c=function(t){return t&&(t=(t=(t=(t=(t=(t=t.replace(/\$\(V_AUTOPLAYED\)/,!1)).replace(/\$\(V_PLAYER_WIDTH\)/,e.clientHeight)).replace(/\$\(V_PLAYER_HEIGHT\)/,e.clientWidth)).replace(/\$\(V_SKIP_AVAIL\)/,!1)).replace(/\$\(V_EXPANDED\)/,!1)).replace(/\$\(V_AUD_INFO\)/,2)),t},m=function(){var l,d,m,u=document.getElementsByClassName("js-sponsored-moments"),w=document.getElementById("community-bar"),f=document.documentElement;if(f&&f.className.indexOf("smad-scroller")>=0&&(u=document.getElementsByClassName("smad-container")),u&&u.length>0)for(l=0;l<u.length;l++)if(d=u[l],m=void 0,(m=d.getBoundingClientRect()).left<=a&&m.right>=0&&m.top<=r&&m.bottom>=0&&m.bottom>=r-70&&(!w||w.offsetHeight<100))document.documentElement&&document.documentElement.classList&&document.documentElement.classList.add("sponsored-moments-in-view");else if(document.documentElement&&document.documentElement.classList){var v=u[l].getElementsByClassName("js-image-container-full-screen");v&&v.length||document.documentElement.classList.remove("sponsored-moments-in-view")}if(e&&t){var h=t&&t.duration,A=e.getBoundingClientRect();if(A.top<r&&A.bottom>0){t.currentTime=(window.pageYOffset-o)*h/i;var E=(r-A.top)/r*100;E=5*Math.ceil(E/5),window&&window.wafer&&window.wafer.utils&&(E>=100&&s.quartileActionUrl100?(window.wafer.utils.fireBeacon(c(s.quartileActionUrl100),{useNavigator:!1}),s.quartileActionUrl100=null):E>=75&&s.quartileActionUrl75?(window.wafer.utils.fireBeacon(c(s.quartileActionUrl75),{useNavigator:!1}),s.quartileActionUrl75=null):E>=50&&s.quartileActionUrl50?(window.wafer.utils.fireBeacon(c(s.quartileActionUrl50),{useNavigator:!1}),s.quartileActionUrl50=null):E>=25&&s.quartileActionUrl25?(window.wafer.utils.fireBeacon(c(s.quartileActionUrl25),{useNavigator:!1}),s.quartileActionUrl25=null):E>=5&&s.startActionUrl&&(window.wafer.utils.fireBeacon(c(s.startActionUrl),{useNavigator:!1}),s.startActionUrl=null))}}if(n){var g=document.getElementsByClassName("dynamic-moments")[0];if(!g||!g.getBoundingClientRect)return;var p=g.getBoundingClientRect(),y=p.top,L=y<=650,b=p.bottom<=320,D=n.querySelector("li");if(!D)return;var M=D.className.includes("active");if(L&&!b&&M){var R=.35*(650-y),S=Math.round(200-R);n.style.transform="translateX(".concat(S,"px)")}}},u=function(){r=window.innerHeight||document.documentElement.clientHeight,a=window.innerWidth||document.documentElement.clientWidth,l=Math.min(l,r),m()},w=document.getElementsByClassName("js-sponsored-moments");if(w&&w.length>0)for(var f=0;f<w.length;f++){var v=w[f].getElementsByClassName&&w[f].getElementsByClassName("js-panorama-scroll-view");v[0]&&(v[0].scrollLeft=(v[0].scrollWidth-a)/2)}function h(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1}function A(){var e=document.getElementsByClassName("js-playable-moments"),t=document.getElementsByClassName("js-sponsored-3d-ad"),n=t.length>0?t:document.getElementsByClassName("js-regularGemini3dAd");this.scrollPosition=0;if(e){this.header=document.getElementById("module-header");for(var o=0;o<e.length;o++)window.DARLA?this.renderPlayableMomentsIframe(e[o]):e[o].style.display="none"}n&&n[0]&&(window.DARLA?this.renderThreeDimensionalAdIframe(n[0]):n[0].style.display="none")}A.prototype={renderPlayableMomentsIframe:function(e){if(e.hasAttribute("data-playable-src")){var t=e.getAttribute("data-playable-src");this.renderIframeInDarla(t);var n=e.querySelector(".js-tap-to-play"),o=e.querySelector(".js-back-to-home");n&&o&&(n.addEventListener("click",this.startPlayableMomentsFullScreenDwellTime.bind(this)),o.addEventListener("click",this.endPlayableMomentsFullScreenDwellTime.bind(this)))}},renderThreeDimensionalAdIframe:function(e,t){var n=this,o=!1;if(e.hasAttribute("data-3d-src")){e.hasAttribute("data-3d-type")&&"regularGemini"===e.getAttribute("data-3d-type")&&(o=!0);var i=a>320?60:6,r=o?1*a/1.9:a-i,l=o?a:a-i,s=e.getAttribute("data-3d-src"),d=e.getAttribute("data-3d-dest"),c=e.getAttribute("data-3d-cpos"),m=o?"3DMOMENTS-"+c:t?"3DMOMENTSMODAL":"3DMOMENTS";if(window.DARLA.inProgress())setTimeout((function(){n.renderThreeDimensionalAdIframe(e)}),500);else{var u={dest:d,flex:{h:{min:r},w:{min:l}},h:r,id:m,supports:{"exp-ovr":1,"exp-push":1,"resize-to":1},w:l};window.DARLA.addPos(u);var w=new window.DARLA.Response(m,{}),f='<iframe src="'+s+'" width="'+l+'" height="'+r+'" scrollable="no" frameborder="no"></iframe>';w.add(m,f),window.DARLA.render(w)}}},renderIframeInDarla:function(e){var t=this;if(window.DARLA.inProgress())setTimeout((function(){t.renderIframeInDarla(e)}),500);else{var n={dest:"defaultPLAYMOMENTS",flex:{w:{min:a}},h:l,id:"PLAYMOMENTS",w:a,supports:{"exp-ovr":1,"exp-push":1,"resize-to":1}};window.DARLA.addPos(n);var o=new window.DARLA.Response("PLAYMOMENTS",{}),i='<iframe src="'+e+'" width="'+a+'" height="'+l+'" scrollable="no" frameborder="no"></iframe>';o.add("PLAYMOMENTS",i),window.DARLA.render(o)}},startPlayableMomentsFullScreenDwellTime:function(){window.addEventListener("touchmove",h,{passive:!1}),document.documentElement.classList.add("sponsored-moments-in-view"),void 0!==window.pageYOffset&&window.scrollTo&&(this.scrollPosition=window.pageYOffset,document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",document.body.style.position="fixed"),this.header&&(this.header.style.display="none")},endPlayableMomentsFullScreenDwellTime:function(){window.removeEventListener("touchmove",h),void 0!==window.pageYOffset&&window.scrollTo&&(document.body.style.removeProperty("overflow"),document.documentElement.style.removeProperty("overflow"),document.body.style.removeProperty("position"),window.scrollTo(0,this.scrollPosition)),this.header&&this.header.style.removeProperty("display")}},window.addEventListener?(window.addEventListener("onSmStackChange",d,!1),window.addEventListener("DOMContentLoaded",m,!1),window.addEventListener("load",m,!1),window.addEventListener("scroll",window.wafer.utils.throttle(m,16),!1),window.addEventListener("resize",window.wafer.utils.throttle(u,16),!1)):(window.attachEvent("onSmStackChange",d),window.attachEvent("onDOMContentLoaded",m),window.attachEvent("onload",m),window.attachEvent("onscroll",m),window.attachEvent("onresize",u)),setTimeout((function(){new A}),200),window.wafer&&window.wafer.ready((function(){var e=document.querySelector(".sponsored-moments"),t="js-sponsored-moments-dwell-time",n=e&&e.querySelectorAll("."+t+", ."+t+"-mon"),o=function e(t,n){var o=Math.floor(16*a/9),i=t.querySelector("#defaultRESERVEMOMENTS"),r=i&&i.getAttribute("data-html");if(r)if(window.DARLA.inProgress())setTimeout((function(){e(t,n)}),500);else{var l={dest:"defaultRESERVEMOMENTS",h:n?250:o,id:"RESERVEMOMENTS",supports:{"exp-ovr":1,"exp-push":1,"resize-to":1},w:n?300:a};n||(l.flex={h:{min:o},w:{min:a}}),window.DARLA.addPos(l);var s=new window.DARLA.Response("RESERVEMOMENTS",{});r=unescape(r),s.add("RESERVEMOMENTS",r),window.DARLA.render(s)}};if(n&&n.length){n.forEach((function(e){e.classList&&(e.classList.contains("js-reserve-moments")||e.classList.contains("js-small-reserve-moments"))&&(window.DARLA?o(e,e.classList.contains("js-small-reserve-moments")):e.style.display="none")}));var i=n[0].querySelector(".js-panorama-scroll-view");i&&0===i.scrollLeft&&(i.scrollLeft=(i.scrollWidth-a)/2)}}))}();